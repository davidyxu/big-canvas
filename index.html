<html>
<head>
<link rel="stylesheet" type="text/css" href="https://s3.amazonaws.com/big-canvas/assets/css/big-canvas.css">
<script src="/socket.io/socket.io.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>

<script src="https://s3.amazonaws.com/big-canvas/assets/js/room.js"></script>
<script src="https://s3.amazonaws.com/big-canvas/assets/js/big-canvas.js"></script>
<script>
	var socket = io.connect(window.location.hostname);
  socket.on('connect', function(){
    console.log("connected")
  });
  socket.on('start', function(x, y) {
  	$(function() {
			BC.initialize(x, y);
  	});
  });
  socket.on('test', function(data) {
		console.log(data);
		console.log("data");
	})
	socket.on('updatecanvas', function(roomID, history) {
		var parsedID = roomID.slice(1).split('y');
		var room = BC.findRoom(parseInt(parsedID[0]), parseInt(parsedID[1]))

		room.drawHistory(history);
	})

	socket.on('loadhistory', function(roomID, url) {
		var parsedID = roomID.slice(1).split('y');
		var room = BC.findRoom(parseInt(parsedID[0]), parseInt(parsedID[1]))
		room.loadURL(url);
	});

  $(function() {

	//	BC.initialize(0, 0);
  // 	context = $('canvas')[0].getContext("2d");
		// context.strokeStyle = "red";
		// context.lineWidth = 1.0;
		// context.lineJoin = "round";


	 //  socket.on('drawBoard', function(dataURL) {
	 //  	var img = new Image();  
	 //    img.onload = function(){  
	 //        context.drawImage(img, 0, 0);  
	 //    }  
	 //    img.src = dataURL;  
	 //  	console.log(dataURL);
	 //  });

	 //  //draw a single canvas
	 //  socket.on('updatecanvas', function(data) {
	 //  	context.beginPath();
		// 	context.moveTo(data.fromX, data.fromY);
		// 	context.lineTo(data.toX, data.toY);
		// 	context.stroke();
		// 	context.closePath();
	 //  });

	 //  //draw queue of draw commands
	 //  socket.on('drawAll', function(drawHistory) {
	 //  	for (var i = 0; i < drawHistory.length; i++) {
		//   	context.beginPath();
		// 		context.moveTo(drawHistory[i].fromX, drawHistory[i].fromY);
		// 		context.lineTo(drawHistory[i].toX, drawHistory[i].toY);
		// 		context.stroke();
		// 		context.closePath();
	 //  	}
	 //  })


		// //actionlisteners
		// $('canvas').mousedown(function(e) {
		// 	fromX = e.pageX
		// 	fromY = e.pageY
		// });
		// $('canvas').mousemove(function(e) {
		// 	if (fromX) {
		// 		toX = e.pageX
		// 		toY = e.pageY
		// 		var data = {
		// 			fromX:fromX,
		// 			fromY:fromY,
		// 			toX: toX,
		// 			toY: toY	
		// 		};
		//   	context.beginPath();
		// 		context.moveTo(data.fromX, data.fromY);
		// 		context.lineTo(data.toX, data.toY);
		// 		context.stroke();
		// 		context.closePath();

		// 		socket.emit('draw', data)
		// 		fromX = toX
		// 		fromY = toY
		// 	}
		// });
  });
</script>
</head>
<body>
	<div id="viewport"></div>
</body>
</html>